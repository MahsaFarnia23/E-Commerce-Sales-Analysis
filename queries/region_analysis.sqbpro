--Region Analysis:

SELECT
    region,
    COUNT(DISTINCT order_id)              AS total_orders,
    ROUND(SUM(sales), 2)                  AS total_sales,
    ROUND(SUM(profit), 2)                 AS total_profit,
    ROUND(AVG(discount), 4)               AS avg_discount,
    ROUND((SUM(profit) * 100.0 / SUM(sales)), 2) AS profit_margin_pct
FROM orders_clean
GROUP BY region
ORDER BY total_sales DESC;
